@if (open && product) {
<div class="fixed inset-0 z-[120] flex items-center justify-center p-4">
    <div class="absolute inset-0 bg-black/60 backdrop-blur-sm" (click)="close()"></div>
    <div class="relative z-[121] w-full max-w-5xl overflow-hidden rounded-xl bg-white shadow-2xl">
        <button (click)="close()" aria-label="Fechar"
            class="absolute right-3 top-3 rounded-md p-2 text-gray-500 transition hover:text-black">
            <i class="pi pi-times"></i>
        </button>
        <div class="grid gap-0 md:grid-cols-2">
            <div class="flex items-center justify-center bg-gray-50 p-6 md:border-r md:border-gray-100">
                <img [src]="product.imageUrl" [alt]="product.name" class="h-[32rem] w-full object-contain" />
            </div>
            <div class="flex flex-col p-6">
                <div class="mb-2 flex flex-col gap-1">
                    <span class="text-xs font-semibold uppercase tracking-wider text-gray-400">{{ product.category
                        }}</span>
                    <span class="text-xs font-semibold uppercase tracking-wider text-gray-400">{{ product.subcategory
                        }}</span>
                </div>
                <div class="flex items-center justify-between gap-3">
                    <h2 class="text-2xl font-semibold text-gray-900">{{ product.name }}</h2>
                    <button (click)="toggleFavorite()" aria-label="Favorito"
                        class="text-black hover:scale-105 transition">
                        <i class="pi text-[18px]"
                            [ngClass]="isFavorite() ? 'pi-heart-fill text-red-500' : 'pi-heart text-black'"></i>
                    </button>
                </div>
                <div class="mb-4 flex items-baseline gap-3">
                    @if (product.originalPrice && product.originalPrice > product.price) {
                    <span class="text-sm line-through text-gray-500">R$ {{ product.originalPrice | number:'1.2-2'
                        }}</span>
                    }
                    <span class="text-2xl font-bold text-gray-900">R$ {{ product.price | number:'1.2-2' }}</span>
                    @if (product.reviews) {
                    <span class="text-xs text-gray-500">{{ product.rating }} â˜… ({{ product.reviews }})</span>
                    }
                </div>
                <p class="text-xs text-gray-500">
                    {{ (product.maxInstallments ?? 2) }}x de R$ {{ (product.price / (product.maxInstallments ?? 2)) | number:'1.2-2' }}*
                </p>
                <p class="mb-6 text-sm leading-relaxed text-gray-600">{{ product.description }}</p>
                @if (product.sizes?.length) {
                <div class="mb-6">
                    <p class="mb-2 text-xs font-semibold uppercase tracking-wider text-gray-500">Selecione o tamanho
                    </p>
                    <div class="flex flex-wrap gap-2">
                        @for (s of product.sizes; track s) {
                        <button type="button" (click)="selectSize(s)"
                            class="rounded-md border px-3 py-2 text-xs font-semibold transition focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-cyan-400"
                            [ngClass]="selectedSize === s ? 'border-black bg-black text-white' : 'border-gray-300 bg-white text-gray-800 hover:border-gray-400'">
                            {{ s }}
                        </button>
                        }
                    </div>
                </div>
                }
                <div class="mt-auto flex items-center gap-3">
                    <button
                        class="rounded-lg bg-black px-6 py-3 text-sm font-semibold text-white shadow-sm transition hover:bg-gray-800 disabled:opacity-50 disabled:cursor-not-allowed focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-cyan-400"
                        [disabled]="product.sizes?.length && !selectedSize" (click)="addToCart(product)">
                        Adicionar ao carrinho
                    </button>
                    <button (click)="close()"
                        class="text-sm font-medium text-gray-500 hover:text-gray-800">Cancelar</button>
                </div>
            </div>
        </div>
    </div>
</div>
}